<!DOCTYPE html>
<html>
<head>
    <title>LiquidityX LP Staking</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="images/favicon.ico" type="image/x-icon">
    <script src="https://cdn.ethers.io/lib/ethers-5.7.umd.min.js"></script>
</head>
<body>
    <div id="app">
        <header>
            <h1>LiquidityX LP Staking</h1>
            <div id="wallet-address">Not connected</div>
            <button id="connect-btn">Connect Wallet</button>
            <button id="disconnect-btn">Disconnect</button>
        </header>

        <section id="staking-info">
            <h2>Staking Information</h2>
            <p id="apr">APR: Loading...</p>
            <p id="lqx-balance">LQX Balance: -</p>
            <p id="lp-balance">LP Token Balance: -</p>
            <p id="staked-amount">Staked Amount: -</p>
            <p id="earned-rewards">Pending Rewards: -</p>
            <button id="refresh-apr-btn">Refresh APR</button>
        </section>

        <section id="staking-actions">
            <h2>Actions</h2>
            <input type="number" id="stake-amount" placeholder="Enter amount to stake">
            <button id="stake-btn">Stake</button>

            <input type="number" id="unstake-amount" placeholder="Enter amount to unstake">
            <button id="unstake-btn">Unstake</button>

            <button id="claim-btn">Claim Rewards</button>
        </section>

        <footer>
            <p>LiquidityX - Decentralized LP Staking on Polygon</p>
        </footer>
    </div>

    <script>
        const { ethers } = window;

        let provider;
        let signer;
        let connectedAddress = '';

        // Ανίχνευση διαθέσιμων wallets
        async function detectWallets() {
            const wallets = [];
            
            if (window.ethereum) {
                wallets.push('MetaMask');
                
                if (window.ethereum.isCoinbaseWallet) wallets.push('Coinbase Wallet');
                if (window.ethereum.isTrust) wallets.push('Trust Wallet');
                if (window.ethereum.isTokenPocket) wallets.push('TokenPocket');
                if (window.ethereum.isMetaMask) {
                    if (window.ethereum.isBraveWallet) wallets.push('Brave Wallet');
                }
            }
            
            if (window.BinanceChain) wallets.push('Binance Chain Wallet');
            
            console.log("💡 Available Wallets Detected:", wallets);
            return wallets;
        }

        // Συνάρτηση σύνδεσης wallet
        async function connectWallet() {
            if (!window.ethereum && !window.BinanceChain) {
                alert('Please install a Web3 wallet like MetaMask, Trust Wallet, Coinbase Wallet, etc.');
                return;
            }

            try {
                console.log("🔌 Attempting to connect wallet...");

                if (window.BinanceChain) {
                    provider = new ethers.providers.Web3Provider(window.BinanceChain, "any");
                    await window.BinanceChain.enable();
                } else {
                    provider = new ethers.providers.Web3Provider(window.ethereum, "any");
                    await provider.send("eth_requestAccounts", []);
                }

                signer = provider.getSigner();
                connectedAddress = await signer.getAddress();
                
                console.log("✅ Wallet Connected Successfully:", connectedAddress);
                document.getElementById('wallet-address').textContent = `Connected: ${connectedAddress}`;

            } catch (error) {
                console.error("❌ Connection error:", error);
            }
        }

        // Συνάρτηση αποσύνδεσης wallet
        function disconnectWallet() {
            console.log("🔌 Disconnecting Wallet...");
            provider = null;
            signer = null;
            connectedAddress = '';
            document.getElementById('wallet-address').textContent = 'Disconnected';
            console.log("✅ Wallet Disconnected Successfully");
        }

        // Event Listeners
        document.getElementById('connect-btn').addEventListener('click', connectWallet);
        document.getElementById('disconnect-btn').addEventListener('click', disconnectWallet);

        // Ανίχνευση wallets κατά την φόρτωση της σελίδας
        detectWallets();
    </script>
</body>
</html>
